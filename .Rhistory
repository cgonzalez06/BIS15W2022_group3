bbox <- make_bbox(long, lat, f = 0.05)
map1 <- get_map(bbox, maptype = "terrain", source = "stamen")
ggmap(map1)
lat <- c(36, 40)
long <- c(-91, -81)
bbox <- make_bbox(long, lat, f = 0.05)
map1 <- get_map(bbox, maptype = "terrain", source = "stamen")
ggmap(map1)
ggmap(map1) +
geom_point(data = zip_merged, aes(lng, lat)) +
labs(x = "Longitude", y = "Latitude", title = "Animal Bite Locations")
?albersusa
us<-map_data('state')
ggplot(zip_merged,aes(longitude,latitude)) +
geom_polygon(data=us,aes(x=lng,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = count),size=.15,alpha=.25) +
xlim(-125,-65)+ylim(20,50)
us<-map_data('state')
ggplot(zip_merged,aes(longitude,latitude)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = count),size=.15,alpha=.25) +
xlim(-125,-65)+ylim(20,50)
us<-map_data('state')
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = count),size=.15,alpha=.25) +
xlim(-125,-65)+ylim(20,50)
ggplot(zip_merged,aes(lng,lat))
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)
zip_codes <- animal_bites %>%
filter(!is.na(zipcode)) %>%
count(zipcode)
zip_merged <- left_join(zip_codes, zip_code_db, by = "zipcode")
zip_merged %>%
select(zipcode, lat, lng)
zip_codes <- animal_bites %>%
filter(!is.na(zipcode)) %>%
count(zipcode)
zip_codes <- animal_bites %>%
filter(!is.na(zipcode)) %>%
count(zipcode)
library(zipcodeR)
library(tidyverse)
library(janitor)
library(naniar)
library(shiny)
library(shinydashboard)
library(maps)
library(viridis)
library(ggthemes)
library(albersusa)
glimpse(animal_bites)
animal_bites <- read_csv("/Users/cristina/Desktop/BIS15W2022_group3/data/Animal_Bites.csv") %>%
clean_names() %>%
separate(bite_date, into = c("year", "month", "date"), sep= "-") %>%
mutate(zipcode=as.character(victim_zip)) %>%
select(-victim_zip)
#Look up package lubridate
animal_bites %>%
filter(species_id_desc=="DOG") %>%
count(breed_id_desc) %>%
na.omit() %>%
arrange(desc(n))
animal_bites %>%
filter(species_id_desc=="DOG") %>%
filter(year>=2010 & year<=2022) %>%
ggplot(aes(x=month))+
geom_bar()
animal_bites %>%
filter(gender_id_desc=="MALE" | gender_id_desc=="FEMALE") %>%
filter(breed_id_desc=="PIT BULL" | breed_id_desc=="GERM SHEPHERD" | breed_id_desc=="LABRADOR RETRIV" | breed_id_desc=="BOXER" | breed_id_desc=="CHICHAUHUA" | breed_id_desc=="SHIH TZU") %>%
ggplot(aes(x=gender_id_desc, fill=breed_id_desc))+
geom_bar()+
facet_wrap(~breed_id_desc)
animal_bites %>%
count(species_id_desc)
animal_bites %>%
filter(results_id_desc=="POSITIVE")
animal_bites %>%
count(vaccination_yrs)
animal_bites %>%
count(color)
animal_bites %>%
filter(results_id_desc=="POSITIVE") %>%
count(species_id_desc)
ui <-dashboardPage(
dashboardHeader(title = "Dog Bites"),
dashboardSidebar(disable=T),
dashboardBody(
fluidRow(
box(title = "Plot Options", width = 3,
selectInput("x", "Select Breed", choices = c("PIT BULL", "GERM SHEPHERD", "LABRADOR RETRIV", "BOXER", "CHICHAUHUA", "SHIH TZU", "BEAGLE", "ROTTWEILER", "AAUST. TERR.", "DACHSHUND"),
selected = "PITBULL")),
box(title = "Bites per Sex", width = 7,
plotOutput("plot", width = "600px", height="500px"))
)
)
)
server <-function(input, output, session) {
output$plot <- renderPlot({
animal_bites %>%
filter(gender_id_desc=="MALE" | gender_id_desc=="FEMALE") %>%
filter(breed_id_desc==input$x) %>%
ggplot(aes_string(x="gender_id_desc", fill="gender_id_desc"))+
geom_bar()+
theme_classic()+
labs(x="Sex",
y="Number of Bites Recorded")+
theme(axis.text=element_text(size=14, face="bold"),
axis.title=element_text(size=14,face="bold"))
})
session$onSessionEnded(stopApp)
}
shinyApp(ui, server)
zip_codes <- animal_bites %>%
filter(!is.na(zipcode)) %>%
count(zipcode)
zip_merged <- left_join(zip_codes, zip_code_db, by = "zipcode")
zip_merged %>%
select(zipcode, lat, lng, )
zip_merged %>%
select(lat, lng) %>%
summary()
lat <- c(36, 40)
long <- c(-91, -81)
bbox <- make_bbox(long, lat, f = 0.05)
map1 <- get_map(bbox, maptype = "terrain", source = "stamen")
zip_codes <- animal_bites %>%
filter(!is.na(zipcode)) %>%
count(zipcode)
zip_codes
zip_merged %>%
select(zipcode, lat, lng, n)
us<-map_data('state')
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = n),size=.15,alpha=.25) +
xlim(-125,-65)+ylim(20,50)
us<-map_data('state')
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = n),size=.15,alpha=.25) +
xlim(-91,-81)+ylim(36,40)
us<-map_data('state')
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = n),size=1,alpha=.25) +
xlim(-91,-81)+ylim(36,40)
us<-map_data('state')
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = n),size=1,alpha=.5) +
xlim(-91,-81)+ylim(36,40)
us<-map_data('state')
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = n),size=1.5,alpha=.5) +
xlim(-91,-81)+ylim(36,40)
us<-map_data('state')
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = n),size=1.5,alpha=.75) +
xlim(-91,-81)+ylim(36,40)
data.fm %>%
ggplot(aes(fill = x, color = x)) +
geom_sf() +
scale_fill_viridis(option = "B",direction=-1) +
scale_color_viridis(option = "B",direction=-1) +
theme_map(base_size=11)
zip_merged %>%
ggplot(aes(fill = x, color = x)) +
geom_sf() +
scale_fill_viridis(option = "B",direction=-1) +
scale_color_viridis(option = "B",direction=-1) +
theme_map(base_size=11)
zip_merged %>%
ggplot(aes(fill = lat, color = n)) +
geom_sf() +
scale_fill_viridis(option = "B",direction=-1) +
scale_color_viridis(option = "B",direction=-1) +
theme_map(base_size=11)
zip_merged %>%
ggplot(aes(fill = n, color = n)) +
geom_sf() +
scale_fill_viridis(option = "B",direction=-1) +
scale_color_viridis(option = "B",direction=-1) +
theme_map(base_size=11)
fm.counties<-aggregate(fm$count,by=list(fm$county,fm$state),sum)
zip_merged<-aggregate(zip_merged$n,by=list(fm$county,fm$state),sum)
ky_cnty_comp <- cnty_comp %>%
filter(state=="Kentucky")
us<-map_data('state')
ky_cnty_comp <- cnty_comp %>%
filter(state=="Kentucky")
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = n),size=1.5,alpha=.75) +
xlim(-91,-81)+ylim(36,40)
us<-map_data('state')
ky_cnty_comp <- cnty_comp %>%
filter(state=="Kentucky")
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = n),size=1.5,alpha=.75) +
xlim(-91,-81)+ylim(36,40)
us<-map_data('state')
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = n),size=1.5,alpha=.75) +
xlim(-91,-81)+ylim(36,40)+
theme_bw
us<-map_data('state')
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=.35)+
geom_point(aes(color = n),size=1.5,alpha=.75) +
xlim(-91,-81)+ylim(36,40)+
theme_bw()
us<-map_data('state')
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=1)+
geom_point(aes(color = n),size=1.5,alpha=.75) +
xlim(-91,-81)+ylim(36,40)+
theme_bw()
us<-map_data('state')
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=1)+
geom_point(aes(color = n),size=1.5,alpha=.75) +
xlim(-91,-81)+ylim(36,40)+
theme_minimal()
us<-map_data('state')
ggplot(zip_merged,aes(lng,lat)) +
geom_polygon(data=us,aes(x=long,y=lat,group=group),color='gray',fill=NA,alpha=1)+
geom_point(aes(color = n),size=1.5,alpha=.75) +
xlim(-91,-81)+ylim(36,40)+
theme(panel.grid = element_blank())
ky_comp <- us_comp %>%
filter(name=="Kentucky")
ky_cnty_comp <- cnty_comp %>%
filter(state=="Kentucky")
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = spiders, aes(lng, lat))
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat))
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat), size=0.8)+
labs(x = "Distribution of Animal Bites in Kentucky")+
theme_minimal() +
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ca_comp, size = 0.125)+
geom_sf(data = ca_cnty_comp, size = 0.125)+
geom_point(data = spiders, aes(longitude, latitude), size=0.8)+
xlim(-91,-81)+ylim(36,40)+
labs(x = "Figure 1: Distribution of Usofila spiders")+
theme_minimal() +
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat), size=0.8)+
xlim(-91,-81)+ylim(36,40)+
labs(x = "Distribution of Animal Bites in Kentucky")+
theme_minimal() +
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat), size=0.8)+
xlim(-91,-81)+ylim(36,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat, color=n), size=0.8)+
xlim(-91,-81)+ylim(36,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat, color=n), size=0.8, alpha=0.5)+
xlim(-91,-81)+ylim(36,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat, color=n), size=0.8, alpha=0.5)+
xlim(-91,-81)+ylim(36,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
scale_color_viridis()
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat, color=n), size=0.8, alpha=0.5)+
xlim(-91,-81)+ylim(36,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
scale_color_viridis()+
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat, color=n), size=0.8, alpha=0.5)+
xlim(-91,-81)+ylim(36,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
scale_color_magma()+
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat, color=n), size=0.8, alpha=0.5)+
xlim(-91,-81)+ylim(36,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
scale_color_viridis(option=magma)+
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat, color=n), size=0.8, alpha=0.5)+
xlim(-91,-81)+ylim(36,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
scale_color_viridis(option="A")+
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat, color=n), size=0.8, alpha=0.75)+
xlim(-91,-81)+ylim(36,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
scale_color_viridis(option="A")+
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat, color=n), size=0.8, alpha=0.75)+
xlim(-87,-88)+ylim(36,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
scale_color_viridis(option="A")+
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat, color=n), size=0.8, alpha=0.75)+
xlim(-87,-85)+ylim(36,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
scale_color_viridis(option="A")+
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat, color=n), size=0.8, alpha=0.75)+
xlim(-87,-85)+ylim(38,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
scale_color_viridis(option="A")+
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ky_comp, size = 0.125)+
geom_sf(data = ky_cnty_comp, size = 0.125)+
geom_point(data = zip_merged, aes(lng, lat, color=n), size=0.8, alpha=0.75)+
xlim(-91,-81)+ylim(36,40)+
labs(x = "Distribution of Animal Bites around Louisville")+
theme_minimal() +
scale_color_viridis(option="A")+
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
ggplot() +
geom_sf(data = ca_comp, size = 0.125)+
geom_sf(data = ca_cnty_comp, size = 0.125)+
geom_point(data = spiders, aes(longitude, latitude), size=0.8)+
labs(x = "Figure 1: Distribution of Usofila spiders")+
theme_minimal() +
theme(axis.text = element_blank()) +
theme(axis.title.x = element_text(hjust=0.5, size = 10)) +
theme(axis.title.y = element_blank()) +
theme(panel.grid = element_blank()) +
theme(legend.position = c(0.9, 0.3)) -> uso_map
uso_map
knitr::opts_chunk$set(echo = TRUE)
ui <-dashboardPage(
dashboardHeader(title = "Gabon"),
dashboardSidebar(disable=T),
dashboardBody(
fluidRow(
box(title = "Plot Options", width = 3,
selectInput("x", "Select Animal", choices = c("ra_birds", "ra_monkeys", "ra_apes", "ra_elephant", "ra_ungulate", "ra_rodent"),
selected = "ra_birds")),
box(title = "Relative Abundance of Taxonomic Guild with Distance to Nearest Village", width = 7,
plotOutput("plot", width = "600px", height="500px"))
)
)
)
server <-function(input, output, session) {
output$plot <- renderPlot({
ggplot(gabon, aes_string(x="distance", y=input$x))+
geom_point(size=6)+
geom_smooth(method=lm, color= "black", size=2)+
theme_classic()+
labs(x="Distance to village (km)",
y="Relative abundance (%)")+
theme(axis.text=element_text(size=14, face="bold"),
axis.title=element_text(size=14,face="bold"))
})
session$onSessionEnded(stopApp)
}
shinyApp(ui, server)
animal_bites %>%
filter(gender_id_desc=="MALE" | gender_id_desc=="FEMALE") %>%
filter(breed_id_desc=="PIT BULL" | breed_id_desc=="GERM SHEPHERD" | breed_id_desc=="LABRADOR RETRIV" | breed_id_desc=="BOXER" | breed_id_desc=="CHICHAUHUA" | breed_id_desc=="SHIH TZU") %>%
ggplot(aes(x=gender_id_desc, fill=breed_id_desc))+
geom_bar()+
facet_wrap(~breed_id_desc)
